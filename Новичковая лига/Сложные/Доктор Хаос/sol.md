Заходим на сервер видим что весь функционал это инпут форма и кнопка, которая возвращает что-то бинарное (из текста - скорее всего что-то зашифрованное)

Исходники есть, читаем их. Узнаем следующее:

- наш текст вместе с **флагом** компрессятся и энкодятся как grpc message (в строку)

- это сообщение-строка зашифровывается через rc4 шифр и возвращается клиенту

- шифр 32 бита (слишком большой для прямого перебора)

- генерируется этот шифр на каждый запрос с помощью глобального `std::default_random_engine` (немного завернутого, но суть такая если доки почитать)

Замечаем что переменная-генератор `random_engine_` явно нигде не инициализируется. Потыкавшись в доки/сорс коды узнаем что там есть дефолтный фиксированный сид (константа по идее). То есть собрав docker image по данному нам Dockerfile мы можем получить такой же рандом сид как на сервере. Чтобы узнать ключ остается получить такой же стейт. 

Стейт находим прямым перебором - явно на сервер не приходило слишком много запросов чтобы он ушел сильно далеко от изначального. Пишем cpp говнокод прогу взяв за основу данный исходник (больше будет как псевдокод чтобы не мешались всякие неймспейсы):

```cpp
  std::string data = read_file();
  for (int i; i <= 1000000; i++) {
    std::string decrypted = EncryptBirthmaRC4(data); // fun fact: in rc4 encrypt==decrypt
    // parse grpc message & get fields
    std::string anamnesis = DecodeAnamenesis(decrypted);
    std::string flag = DecodeFlag(decrypted);
    if (anamnesis.length() > 0) {
      // uncompress just uses zlib functions
      std::string uncompressed_f = uncompress(flag);
      if (uncompressed_f.length() > 0) {
        std::cout << uncompressed_f;
      }
    }
  }
```

После борьбы с cmake'ом и c++'ом и после небольшого print-дебага все работает и выводит ключ (файл соответственно получен с сервера)

tl;dr

- на сервере константный рандом сид, использующийся для генерации ключей шифрования.

- ключами шифруют флаг + наш инпут.

- с этим сидом генерим ключи пока не найдем попавшийся нам, дешифруем, получаем флаг.
